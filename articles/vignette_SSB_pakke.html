<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SSB mal for R-pakker • fellesr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SSB mal for R-pakker">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fellesr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/web_only/bygge-en-r-tilleggspakke.html">Hvordan å bygge en R-pakke</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/kjre-r-p-sl-stata-p3-fra-sas.html">Kjøre R på sl-stata-p4 fra SAS</a></li>
    <li><a class="dropdown-item" href="../articles/vignette__DAPLA_jukseark.html">DAPLA jukseark</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_dynarev_uttrekk.html">Uttrekk fra Dynarev til R</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_shiny_ssb.html">Kjøre shiny og Esquisse i Jupyter</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_SSB_fargepalett.html">SSB fargepallet fra KLASS</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_SSB_pakke.html">SSB mal for R-pakker</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_SSB_theme.html">SSB ggplot theme</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_statbank_lasting.html">Lasting til statistikkbanken</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SSB mal for R-pakker</h1>
            
            <h4 data-toc-skip class="date">2024-02-09</h4>
      

      <div class="d-none name"><code>vignette_SSB_pakke.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="hvorfor-bygge-en-r-pakke">Hvorfor bygge en R-pakke?<a class="anchor" aria-label="anchor" href="#hvorfor-bygge-en-r-pakke"></a>
</h2>
<p>R pakker er en god måte å dele koden din med andre. Gjenbruk av kode
er et av de grunnleggende <a href="https://statistics-norway.atlassian.net/wiki/spaces/Arkitektur/pages/3538714625/Arkitekturprinsipper" class="external-link">IT-arkitekturprinsipper</a>
vi bruker i SSB. Utvikling av R-pakker er et positiv bidrag til dette.
Koden blir dokumentert på en standardisert måte og det kan lett deles
med andre internt og eksternt. Det er gode løsninger for avhengighet
mellom pakker og funksjoner i ulike pakker. Hovedårsakene for å bygge
R-pakker:</p>
<ul>
<li>Lett å delekode med andre</li>
<li>Organisere arbeid</li>
<li>Dokumentasjon for både deg selv og andre</li>
</ul>
<p>Desverre kan det være et høyt terskel til å bygge en pakke, særlig
hvis du ikke har gjort dette før. Gruppen Kvalitet i kode og kode
(KVAKK) har satt opp noen <a href="https://statistics-norway.atlassian.net/wiki/spaces/BEST/pages/3569778806/Regler+og+anbefalinger+for+gjenbruk#Biblioteker" class="external-link">krav
og anbefalinger til pakker som lages i SSB</a>. Det går på ting som
navnestandard, dokumentasjon og testing. For å gjøre det lettere å følge
har KVAKK utviklet et mal som kan brukes for å opprette strukturen for
en R-pakke som følge SSB standarder på en lett måte.</p>
</div>
<div class="section level2">
<h2 id="hvordan-bruke-ssbs-mal-for-r-pakker">Hvordan bruke SSBs mal for R-pakker?<a class="anchor" aria-label="anchor" href="#hvordan-bruke-ssbs-mal-for-r-pakker"></a>
</h2>
<div class="section level3">
<h3 id="før-du-starte">Før du starte<a class="anchor" aria-label="anchor" href="#f%C3%B8r-du-starte"></a>
</h3>
<p>Vi anbefaler å bruke <strong>RStudio</strong> til å lage
R-pakker.</p>
<p>Mal for SSB pakker er inkluderte i SSBs <code>fellesr</code> pakke.
<strong>Sjekk at du har installerte fellesr</strong> fra før ved å
skrive</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statisticsnorway.github.io/fellesr/" class="external-link">fellesr</a></span><span class="op">)</span></span></code></pre></div>
<p>Hvis ikke det er installert følg instruk <a href="https://github.com/statisticsnorway/fellesr?tab=readme-ov-file#fellesfunksjoner-i-r-for-ssb-fellesr" class="external-link">på
fellesr siden på github</a></p>
<p>SSBs mal for R-pakke sette opp et github repository på
Statisticsnorway område. Noen av prosesser for å sette opp repoen kreve
både “repo” og “workflow”. <strong>Sjekk at tokenet ditt har workflow og
repo scope</strong> ved å logge inn på GitHub, klikk på ikonet ditt oppe
til høyre, velg Settings, Developer settings (helt nederst til venstre),
Personal access tokens og Tokens(classic). Hvis tokenet ditt mangler et
av scopene så lager du et nytt token som <a href="https://manual.dapla.ssb.no/git-og-github.html#sec-pat" class="external-link">beskrevet
i Dapla-manualen</a>.</p>
</div>
<div class="section level3">
<h3 id="start-et-nytt-prosjekt-for-pakken">Start et nytt prosjekt for pakken<a class="anchor" aria-label="anchor" href="#start-et-nytt-prosjekt-for-pakken"></a>
</h3>
<p>For å starte et nytt prosjekt for pakken din, velg File &gt; New
Project… &gt; New Directory.</p>
<p>Det skal åpnes et vindu hvor du kan da velge “SSB R-package”. Velg
dette. <img src="images%2FSSBpakke.png" style="width:60.0%" alt="Picture of project options"></p>
<p>Gi pakken din et navn (ingen mellomrom eller bindestrekk) og fyll inn
en beskrivelse, og navn ditt. Klikk på “Create project” for å opprette
pakken.</p>
<div class="float">
<img src="images%2FSSBpakkeCreate.png" style="width:60.0%" alt="Picture of Create SSB R-package options"><div class="figcaption">Picture of Create SSB R-package options</div>
</div>
<p>En mappe opprettes på område du har valgt å starte prosjektet men med
“ssb-” på foran. Dette er for å fylle navn-standard i SSB. HVis du velge
å opprette et github repository (anbefalt for å kunne dele med andre)
vil det spøres om github brukernavn og github token. Github token må ha
workflow rettigheter for å kunne opprette alle filene. Følge prosessen
videre og godkjenne endringer til README filene som anbefalt.</p>
</div>
<div class="section level3">
<h3 id="hva-er-alle-filene">Hva er alle filene?<a class="anchor" aria-label="anchor" href="#hva-er-alle-filene"></a>
</h3>
<p>Etter du har kommet gjennom prosessen av å opprette mal for pakken
din vil du se at det er mange filer inn i mappen. Hovedkomponenter
er:</p>
<ul>
<li>
<code>R/</code> mappe hvor R-kode skal ligge.</li>
<li>
<code>man/</code> mappe hvor beskrivelsen av funksjoner skal
lagres.</li>
<li>
<code>data/</code> mappe hvor test/syntetiske data kan lagres. Dette
er ikke for ekte data.</li>
<li>
<code>tests/</code> mappe som inneholder enhetstester for funksjoner
i pakken.</li>
<li>En <code>DESCRIPTION</code> fil, som gi en generell beskrivelsen av
pakken.</li>
<li>En <code>NAMESPACE</code> fil, som forklarer hvordan pakken og
funksjoner skal kommunisere med andre pakker.</li>
</ul>
<p>Andre filer som opprettes inkludere en Rstudio prosjekt fil,
<code>pkgname.Rproj</code>, en <code>.buildignore</code> fil som si hva
skal ikke inkluderes/deles videre i mappen, og SSB standard lisens og
sikkerhet filer.</p>
<p>Ved å sette opp en github repo til pakken blir det opprettet en .git
mappe til git filene og .github mappen som inkkludere filer for
automatiske testing og bygging av dokumentasjon.</p>
<p>Filen <code>News.md</code> inkludere informasjon til de som skal
bruke pakken din om endringer i versjoner hvis du utvikle pakken
videre.</p>
</div>
<div class="section level3">
<h3 id="legg-inn-egen-kode">Legg inn egen kode<a class="anchor" aria-label="anchor" href="#legg-inn-egen-kode"></a>
</h3>
<p>Funksjoner kan nå flyttes inn til mappen som heter R/. Det er
anbefalt å dokumentere funksjoner ved roxygen2. Da kan du gi funksjoner
et navn og beskrivelsen i tillegg til å spesifisere parameter og det som
returneres. Det er alltid god praksis å lage noen enkel eksempler som
viser hvordan funksjoner fungere. Mer om dokumentasjon av koden ved
roxygen2 finner du under <a href="https://r-pkgs.org/man.html" class="external-link">Object
documentation</a>.</p>
</div>
<div class="section level3">
<h3 id="redigere-description-fil">Redigere DESCRIPTION-fil<a class="anchor" aria-label="anchor" href="#redigere-description-fil"></a>
</h3>
<p><code>DESCRIPTION</code> filen er en viktig fil som sier noen
generelt om pakken du lager. Det inkluderer navn av pakken, beskrivelsen
og hvem som har skrevet det. Navn av pakken må ikke inkludere “-” eller
mellomrom og kan være ulik reponavn som sannsynligvis inkludere “ssb-”.
Description filen kan åpnes og redigeres direkte i RStudio. Filen også
inkludere informasjon om hvike andre pakker trengs for å kunne kjøre
koden din. Endre dette etter behov. Mer detaljer om DESCRIPTION filen
finner du <a href="https://r-pkgs.org/description.html" class="external-link">her</a></p>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h3>
<p>Det er viktig å lage noen tester (enhetstester) til funksjoner i
pakken din. Dette kan bidra til færre bugs og bedre struktur i koden.
Pakken <a href="https://testthat.r-lib.org" class="external-link">testthat</a> gi et rammeverk
for å lage og kjøre tester. En typisk test er å sjekke at en funksjon
returnere en forventet verdi.</p>
<p>Koden for tester skal ligger i .R filer og skal ligge i pakken under
<a href="https://r-pkgs.org/tests.html#test-organisation" class="external-link">/tests/testthat/</a>.Filnavn
skal starte med <code>test</code>. I tillegg til fil(ene) som inneholder
tester skal det være en fil som heter <code>testthat.R</code>. Dette
lagres i mappen <code>/tests/</code> og gir instruks om det som skal
testes. Mer informajson om testing finner du i <a href="https://r-pkgs.org/tests.html" class="external-link">kapittel 12</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="dele-pakken-med-andre">Dele pakken med andre<a class="anchor" aria-label="anchor" href="#dele-pakken-med-andre"></a>
</h2>
<div class="section level3">
<h3 id="pull-request-og-merge">Pull request og merge<a class="anchor" aria-label="anchor" href="#pull-request-og-merge"></a>
</h3>
<p>Når du har flyttet inn koden din til mappen som ble oprettet ved SSB
mal kan du commit og push endringer til github. Logg inn på repoet på
GitHub og opprett en pull-request. Vent med å legge til Reviewers til du
ser at alle sjekker er “grønne”. Noen av testene kjøres først når du
oppretter en pull-request, slik som kjøring av tester med forskjellige
R-versjoner. Det er greit å sjekke at alt dette går gjennom før du ber
noen se på koden, slik at de slipper å se på den flere ganger.</p>
<p>Når pull requesten er godkjent, så merger du den og sletter branchen.
Pakken blir da “publisert” til Github og er tilgjengelig for
installering av andre
(<code>devtools::install_github("statisticsnorway/ssb-minpakke")</code>).
Dokumentasjonen vil blir automatisk publiserte til GitHub Pages. Linken
til dokumentasjonen er: statisticsnorway.github.io/<repo name>. Sjekk at
dokumentasjon ser ut som forventet.</repo></p>
</div>
<div class="section level3">
<h3 id="konfigurering-av-github-repo">Konfigurering av GitHub-repo<a class="anchor" aria-label="anchor" href="#konfigurering-av-github-repo"></a>
</h3>
<p>SSBs mal for R-pakker opprette repo som intern. Men det mye lettere å
installere public pakker fra github. Det settes en del krav til hvordan
et public GitHub repo i SSB skal være konfigurert <a href="https://github.com/statisticsnorway/adr/blob/main/docs/0006-aapen-kildekode-i-ssb.md#kriterier-for-%C3%A5pen-kildekode" class="external-link">se
ADR0006</a>. Sørg for at disse er oppfylt. Se <a href="https://statistics-norway.atlassian.net/wiki/spaces/BEST/pages/3092709381/Hvordan+opprette+nytt+GitHub-repo#Konfigurere-repo" class="external-link">beskrivelse
av hvordan konfigurere et GitHub-repo</a> for detaljer, og legg til hvem
som skal ha tilgang til repoet.</p>
<p>Send en e-post til <a href="mailto:sikkerhetssenter@ssb.no" class="email">sikkerhetssenter@ssb.no</a> og be om at repoet gjøres
public.</p>
<p>Etter at repoet er public, gjennomfør resterende konfigurasjon som
beskrevet på siden <a href="https://statistics-norway.atlassian.net/wiki/spaces/BEST/pages/3580428373/Hvordan+konfigurere+et+public+GitHub-repo+for+biblioteker" class="external-link">hvordan
konfigurere et public GitHub-repo for biblioteker</a>.</p>
</div>
<div class="section level3">
<h3 id="lag-en-release">Lag en release<a class="anchor" aria-label="anchor" href="#lag-en-release"></a>
</h3>
<p>Release gjøre det enklere å kontrollere versjoner av pakken din
senere. Det betyr at de som bruker pakkenn din kan installere eldre
versjoner av pakke på en lett måte. Dette kan du gjøre fra Github ved å
trykke på “Create a new release”. Release title er vanligvis
versjonsnummer for eks. “v1.0.0”.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Susie Jentoft, Sindre Haugen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
